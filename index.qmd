---
title: "Random Forest Algorithm"
author: "Amy Brown, Jeff Eddy, Armani Harris"
date: "July 12, 2023"
format:
  html:
    code-fold: true
course: STA 6257 - Advance Statistical Modeling
bibliography: references.bib # file contains bibtex for references
#always_allow_html: true # this allows to get PDF with HTML features
---

## Introduction
Random Forests (RF) is a popular ensemble learning algorithm that combines multiple decision trees to improve predictive accuracy and handle complex datasets. This literature review aims to explore ten articles that discuss various aspects of the Random Forest algorithm, including its theoretical foundation, feature selection, data imbalance resolution, interpretability, and comparisons with other classification methods. The selected articles offer valuable insights into the strengths, weaknesses, and practical applications of Random Forest in different domains.

### Literature Review
Breiman [@Breiman2001] introduced the concept of Random Forests and highlighted the importance of the Law of Large Numbers in avoiding overfitting. Liaw and Wiener [@Liaw2002] expanded on this work, focusing on the classification and regression capabilities of RF. They discussed the use of bagging and highlighted the significance of variable importance in RF models.When dealing with datasets containing a high number of variables the importance of feature selection is discussed by Jaiswal, K. & Samikannu, R. [@Jaiswal2017]. Han and Kim investigated the optimal size of candidate feature sets in Random Forest for classification and regression tasks. The study reveals that the default candidate feature set is not always the best performing and that the optimal size can vary depending on the dataset used [@Han2019]. The potential challenges such as overfitting and handling multi-valued attributes exist when using the Random Forest (RF) algorithm. However, the advantages emphasized by Abdulkareem, N. M., & Abdulazeez, A. M entail accuracy, efficiency with large datasets, and minimal data preprocessing requirements [@Abdulkareem2021]. To address the issue of data imbalance, More and Rana [@More2017] reviewed techniques for resolving imbalanced datasets using RF. The various techniques include sampling, weighted Random Forest, and cost-sensitive methods, to handle imbalanced datasets. A practical application of Random Forest in computational biology and bioinformatics was conducted by Boulesteix, A. L. et al. [@Ali2012], providing insights into decision tree construction, handling bias, and recommendations for parameter tuning. Schonlau and Zou [@Schonlau2020] focused on optimizing RF models by tuning parameters and subtree iterations. They discussed the use of out-of-bag (OOB) samples to approximate the model's error during training. Zhu proposes a new algorithm, the SearchSize method, which estimates the optimal feature set size using out-of-bag error methodology [@Tongtian2020]. Tuning these parameters helps achieve higher prediction accuracy Schonlau, M., & Zou, R. Y. [@Schonlau2020]. Aria et al. [@Aria2022] discussed internal approaches that provide a global overview of the model. They mentioned the Mean Decrease Impurity (MDI) as a measure of variable importance and emphasized the visualization of RF classifiers using toolkits.


## Methods

Random Forest algorithm is a supervised learning model consisting of multiple uncorrelated un-pruned decision trees creating a forest.  A decision tree starts are the root node and splits into internal nodes based on the features divided into classes.  Further internal nodes are created based on the data split on the internal node.  The decision tree ends at the leaf node when all the data belongs to the same class [@Ali2012]. The Random Forest algorithm can be used for classification or regression models.  The target selected for the algorithm identifies if the algorithm will use a classification or regression model.  The leaf node will predict a category if a classification model is identified and a numerical value for a regression model.  The prediction is determined by taking the majority vote of all leaf nodes for classification and an average of the leaf nodes for regression.  This process is represented in the flowchart of Figure 1 [@Abdulkareem2021].


![Figure 1 [@Abdulkareem2021]](RF flowchart.png) 


## Analysis and Results
The target variable was binary with categories of no heart disease (1) and heart disease (2). After removing the outlier observation in cholesterol, 269 observations were used to create a random forest algorithm to predict the presence of heart disease. Using the caret package in R, the dataset was split for a training model and a testing model at a 0.7 ratio. This resulted in 189 observations in the training dataset and 80 in the testing dataset. 
 
A default training model based on classification was then created to establish a baseline accuracy. Random Forests are predictive models that form multiple decision trees. At each tree node, a subset of the 13 predictor features were used to introduce randomness into the model. The default training model used 500 decision trees (ntree=500) and determined the optimal number of features to compare to be 2 (mtry= 2). For this classification RF, the decision at each tree node was conducted by Ginni impurity, which is a process of estimating the likelihood that a feature may be misclassified at random, then the feature with the lowest likelihood of misclassification is selected at that node.

The training model was assessed for the best possible number of decision trees, nodes, and number of features to consider at each node. The greatest accuracy was determined to be 200 trees with a node size of 8 and 2 features considered at each node. The final training model produced an accuracy of 0.8947 compared to the default training model with an accuracy of 0.8472, a 4.75% improvement in accuracy over the default RF parameters. 

## Results
Results from the predictive test model indicated that the feature major.vessels was the most influential feature when predicting heart disease from the current dataset with a variable importance score of 100.00. The five most influential features all had variable importance scores above 80.00. These features were blood vessels, chest pain type, thal reversible defect, normal thal, and max heart rate. All five features had a mean decrease Ginni score above 2.2. Resting blood pressure had the lowest variable importance with a score of 0.00 indicating that the feature did not significantly improve the modelâ€™s performance in predicting heart disease within this dataset. Fasting blood sugar was the far less significant than the other features as well, with a score of 4.03. 
Accuracy for the predictive model was calculated to be 82.5% (0.825, CI: 0.7238, 0.9009, p< 0.001). Sensitivity and specificity were calculated at 0.886 and 0.75 respectively. The model has an estimated false positive rate of 25%. 


### Data and Visualization
The Random Forest algorithm is reviewed using the Heart Disease Prediction dataset. There are 270 observations in the dataset without any missing values.  The target is heart disease predicting the presence or absence of heart disease. The target and the other 13 features are listed in Figure 2 [@Singh2023]. The boxplot of each feature is plotted in Figures 3. There is one extreme outlier in feature serum cholesterol. The datapoint will be removed before running the model. 


![Figure 2 [@Singh2023]](Features and Target.png)


![Figure 3](boxplot.png)


### Statistical Modeling

### Conclusion

## References
